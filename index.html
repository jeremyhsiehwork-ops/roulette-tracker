<!DOCTYPE html>
<html lang="zh-HK">
<head>
  <meta charset="UTF-8" />
  <title>Roulette Tracker</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body { font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; padding: 20px; max-width: 900px; margin: 0 auto; }
    h1 { font-size: 24px; margin-bottom: 10px; }
    h2 { font-size: 18px; margin-top: 20px; }
    .form-row { margin-bottom: 10px; }
    label { margin-right: 8px; }
    input[type="number"] { width: 80px; padding: 4px; }
    select { margin-right: 8px; padding: 4px; }
    button { padding: 4px 10px; cursor: pointer; margin-right: 5px; }
    table { border-collapse: collapse; width: 100%; margin-top: 15px; }
    th, td { border: 1px solid #ccc; padding: 4px 6px; text-align: center; font-size: 13px; }
    th { background: #f5f5f5; }
    .summary-box { display: flex; flex-wrap: wrap; gap: 15px; margin-top: 15px; }
    .summary-item { padding: 8px 10px; border: 1px solid #ddd; border-radius: 4px; background: #fafafa; min-width: 140px; }
    .red { color: #c00; font-weight: 600; }
    .black { color: #000; font-weight: 600; }
    .green { color: #060; font-weight: 600; }
    .footer-note { margin-top: 25px; font-size: 12px; color: #666; }
  </style>
</head>
<body>
  <h1>輪盤結果記錄 & 總結</h1>
  <p>輸入每一鋪輪盤結果，系統會自動計算紅 / 黑 / 綠、單 / 雙、大 / 小的統計。</p>

  <!-- 狀態 -->
  <div class="form-row">
    <label>局數：</label>
    <span id="spinCount">0</span>
  </div>

  <!-- 輸入區 -->
  <div class="form-row">
    <label for="number">號碼 (0–36)：</label>
    <input id="number" type="number" min="0" max="36" />
    <label for="color">顏色：</label>
    <select id="color">
      <option value="">自動 (根據號碼)</option>
      <option value="red">紅</option>
      <option value="black">黑</option>
      <option value="green">綠 (0)</option>
    </select>
    <button id="addSpin">新增結果</button>
    <button id="clearAll">清除全部</button>
  </div>

  <!-- 總結區 -->
  <h2>統計總結</h2>
  <div class="summary-box">
    <div class="summary-item">
      總局數：<span id="sumTotal">0</span>
    </div>
    <div class="summary-item">
      紅：<span id="sumRed">0</span> (<span id="sumRedPct">0%</span>)
    </div>
    <div class="summary-item">
      黑：<span id="sumBlack">0</span> (<span id="sumBlackPct">0%</span>)
    </div>
    <div class="summary-item">
      綠(0)：<span id="sumGreen">0</span> (<span id="sumGreenPct">0%</span>)
    </div>
    <div class="summary-item">
      單：<span id="sumOdd">0</span> (<span id="sumOddPct">0%</span>)
    </div>
    <div class="summary-item">
      雙：<span id="sumEven">0</span> (<span id="sumEvenPct">0%</span>)
    </div>
    <div class="summary-item">
      小(1–18)：<span id="sumLow">0</span> (<span id="sumLowPct">0%</span>)
    </div>
    <div class="summary-item">
      大(19–36)：<span id="sumHigh">0</span> (<span id="sumHighPct">0%</span>)
    </div>
  </div>

  <!-- 歷史記錄表 -->
  <h2>歷史記錄</h2>
  <table>
    <thead>
      <tr>
        <th>#</th>
        <th>號碼</th>
        <th>顏色</th>
        <th>單/雙</th>
        <th>大/小</th>
        <th>時間</th>
      </tr>
    </thead>
    <tbody id="historyBody"></tbody>
  </table>

  <p class="footer-note">提示：資料只會儲存在你瀏覽器的本機 (localStorage)，換裝置或清除瀏覽器資料會令記錄消失。</p>

  <script>
    // 典型歐式輪盤紅色號碼列表
    const RED_NUMBERS = new Set([1,3,5,7,9,12,14,16,18,19,21,23,25,27,30,32,34,36]);

    const numberInput = document.getElementById('number');
    const colorSelect = document.getElementById('color');
    const addSpinBtn = document.getElementById('addSpin');
    const clearAllBtn = document.getElementById('clearAll');
    const historyBody = document.getElementById('historyBody');
    const spinCountSpan = document.getElementById('spinCount');

    const sumTotal = document.getElementById('sumTotal');
    const sumRed = document.getElementById('sumRed');
    const sumBlack = document.getElementById('sumBlack');
    const sumGreen = document.getElementById('sumGreen');
    const sumRedPct = document.getElementById('sumRedPct');
    const sumBlackPct = document.getElementById('sumBlackPct');
    const sumGreenPct = document.getElementById('sumGreenPct');
    const sumOdd = document.getElementById('sumOdd');
    const sumEven = document.getElementById('sumEven');
    const sumOddPct = document.getElementById('sumOddPct');
    const sumEvenPct = document.getElementById('sumEvenPct');
    const sumLow = document.getElementById('sumLow');
    const sumHigh = document.getElementById('sumHigh');
    const sumLowPct = document.getElementById('sumLowPct');
    const sumHighPct = document.getElementById('sumHighPct');

    let spins = [];

    function loadFromStorage() {
      const saved = localStorage.getItem('roulette_spins_v1');
      if (saved) {
        try {
          spins = JSON.parse(saved);
        } catch (e) {
          spins = [];
        }
      }
      renderAll();
    }

    function saveToStorage() {
      localStorage.setItem('roulette_spins_v1', JSON.stringify(spins));
    }

    function autoColor(num) {
      if (num === 0) return 'green';
      return RED_NUMBERS.has(num) ? 'red' : 'black';
    }

    function addSpin() {
      const numStr = numberInput.value.trim();
      if (numStr === '') return;
      const num = Number(numStr);
      if (Number.isNaN(num) || num < 0 || num > 36) return;

      let color = colorSelect.value;
      if (!color) color = autoColor(num);

      const isZero = num === 0;
      const oddEven = isZero ? '-' : (num % 2 === 0 ? 'even' : 'odd');
      const lowHigh =
        isZero ? '-' :
        (num >= 1 && num <= 18 ? 'low' : 'high');

      const spin = {
        num,
        color,
        oddEven,
        lowHigh,
        time: new Date().toLocaleTimeString()
      };
      spins.push(spin);
      saveToStorage();
      renderAll();

      numberInput.value = '';
      numberInput.focus();
    }

    function clearAll() {
      if (!confirm('確定清除所有記錄？')) return;
      spins = [];
      saveToStorage();
      renderAll();
    }

    function renderAll() {
      renderTable();
      renderSummary();
    }

    function renderTable() {
      historyBody.innerHTML = '';
      // 最新一局顯示在最上
      const reversed = [...spins].reverse();
      reversed.forEach((spin, idx) => {
        const tr = document.createElement('tr');

        const indexCell = document.createElement('td');
        indexCell.textContent = reversed.length - idx;

        const numCell = document.createElement('td');
        numCell.textContent = spin.num;

        const colorCell = document.createElement('td');
        colorCell.textContent = spin.color;
        colorCell.classList.add(spin.color); // 用 CSS 顏色

        const oddEvenCell = document.createElement('td');
        oddEvenCell.textContent = spin.oddEven;

        const lowHighCell = document.createElement('td');
        lowHighCell.textContent = spin.lowHigh;

        const timeCell = document.createElement('td');
        timeCell.textContent = spin.time || '';

        tr.appendChild(indexCell);
        tr.appendChild(numCell);
        tr.appendChild(colorCell);
        tr.appendChild(oddEvenCell);
        tr.appendChild(lowHighCell);
        tr.appendChild(timeCell);

        historyBody.appendChild(tr);
      });

      spinCountSpan.textContent = spins.length;
    }

    function pct(part, total) {
      if (!total) return '0%';
      return (part / total * 100).toFixed(1) + '%';
    }

    function renderSummary() {
      const total = spins.length;
      let red = 0, black = 0, green = 0;
      let odd = 0, even = 0;
      let low = 0, high = 0;

      spins.forEach(s => {
        if (s.color === 'red') red++;
        else if (s.color === 'black') black++;
        else if (s.color === 'green') green++;

        if (s.oddEven === 'odd') odd++;
        else if (s.oddEven === 'even') even++;

        if (s.lowHigh === 'low') low++;
        else if (s.lowHigh === 'high') high++;
      });

      sumTotal.textContent = total;
      sumRed.textContent = red;
      sumBlack.textContent = black;
      sumGreen.textContent = green;
      sumRedPct.textContent = pct(red, total);
      sumBlackPct.textContent = pct(black, total);
      sumGreenPct.textContent = pct(green, total);

      sumOdd.textContent = odd;
      sumEven.textContent = even;
      sumOddPct.textContent = pct(odd, total);
      sumEvenPct.textContent = pct(even, total);

      sumLow.textContent = low;
      sumHigh.textContent = high;
      sumLowPct.textContent = pct(low, total);
      sumHighPct.textContent = pct(high, total);
    }

    addSpinBtn.addEventListener('click', addSpin);
    numberInput.addEventListener('keyup', e => {
      if (e.key === 'Enter') addSpin();
    });
    clearAllBtn.addEventListener('click', clearAll);

    loadFromStorage();
  </script>
</body>
</html>
